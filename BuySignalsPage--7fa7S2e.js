import{k as K,i as z,r as f,m as $,j as e,o,a3 as A,p as x,B as n,ad as T,a9 as M,I as J,H as k,J as B,K as D,N as q,O as r,q as O,s as Z,t as U,v as P,a4 as _,at as G,b as N,D as W,w as X,b1 as Y,y as Q,g as ee,ag as g,aT as se}from"./index-DE3WvtMD.js";import{C as ae}from"./calendar-DiUGKtnE.js";function le(){const{user:t}=K(),i=z(),[l,v]=f.useState(""),[m,b]=f.useState("all"),[u,w]=f.useState("all"),{data:j,isLoading:F}=$({queryKey:["/api/buy-signals",{category:m!=="all"?m:void 0,search:l||void 0}],refetchInterval:3e4}),{data:p}=$({queryKey:["/api/my-buy-signals"],enabled:!!t}),H=(j==null?void 0:j.signals)||[],C=(p==null?void 0:p.signals)||[],S=H.filter(s=>{const a=!l||s.title.toLowerCase().includes(l.toLowerCase())||s.description.toLowerCase().includes(l.toLowerCase()),d=u==="all"||s.urgency===u;return a&&d}),I={low:"bg-gray-100 text-gray-800 border-gray-200",normal:"bg-blue-100 text-blue-800 border-blue-200",high:"bg-orange-100 text-orange-800 border-orange-200",urgent:"bg-red-100 text-red-800 border-red-200"},E={cannabis:e.jsx(g,{className:"h-4 w-4"}),hemp:e.jsx(g,{className:"h-4 w-4"}),cbd:e.jsx(g,{className:"h-4 w-4"}),thc:e.jsx(g,{className:"h-4 w-4"}),equipment:e.jsx(se,{className:"h-4 w-4"}),services:e.jsx(Q,{className:"h-4 w-4"})},V=(s,a,d="USD")=>{const c=d==="USD"?"$":d==="ZAR"?"R":"â‚¬";return s&&a?`${c}${s.toLocaleString()} - ${c}${a.toLocaleString()}`:s?`${c}${s.toLocaleString()}+`:a?`Up to ${c}${a.toLocaleString()}`:"Budget: Negotiable"},R=s=>{const a=new Date(s),c=new Date().getTime()-a.getTime(),h=Math.floor(c/(1e3*60*60)),y=Math.floor(h/24);return y>0?`${y} day${y>1?"s":""} ago`:h>0?`${h} hour${h>1?"s":""} ago`:"Just posted"},L=({signal:s,showActions:a=!1})=>e.jsxs(o,{className:"hover:shadow-md transition-shadow",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(_,{className:"text-lg mb-2 flex items-center gap-2",children:[E[s.category],e.jsx("span",{className:"truncate",children:s.title})]}),e.jsx(G,{className:"line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[e.jsx(N,{variant:"outline",className:I[s.urgency],children:s.urgency}),!s.isActive&&e.jsx(N,{variant:"secondary",children:"Inactive"})]})]})}),e.jsxs(x,{className:"space-y-4",children:[(s.budgetMin||s.budgetMax||s.targetQuantity)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[(s.budgetMin||s.budgetMax)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:V(s.budgetMin,s.budgetMax,s.currency)})]}),s.targetQuantity&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Quantity:"}),e.jsxs("span",{children:[s.targetQuantity," ",s.unit||"units"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[s.preferredLocation&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:s.preferredLocation})]}),e.jsx(N,{variant:"secondary",className:"text-xs",children:s.category})]}),s.expiresAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsxs("span",{children:["Expires: ",new Date(s.expiresAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:s.viewCount})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{children:s.responseCount})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:R(s.createdAt)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&t&&s.buyer&&s.buyer.id!==t.id&&e.jsx(n,{size:"sm",onClick:()=>i(`/buy-signals/${s.id}/respond`),children:"Respond"}),e.jsx(n,{size:"sm",variant:"outline",onClick:()=>i(`/buy-signals/${s.id}`),children:"View Details"})]})]})]})]},s.id);return F?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,a)=>e.jsxs(o,{className:"animate-pulse",children:[e.jsxs(A,{children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]},a))})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Buy Signals"}),e.jsx("p",{className:"text-muted-foreground",children:"Browse buyer requests and post what you're looking for"})]}),t&&e.jsxs(n,{onClick:()=>i("/buy-signals/create"),className:"gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Create Signal"]})]}),e.jsx(o,{className:"mb-6",children:e.jsx(x,{className:"py-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(J,{placeholder:"Search signals...",value:l,onChange:s=>v(s.target.value),className:"pl-9"})]}),e.jsxs(k,{value:m,onValueChange:b,children:[e.jsx(B,{children:e.jsx(D,{placeholder:"Category"})}),e.jsxs(q,{children:[e.jsx(r,{value:"all",children:"All Categories"}),e.jsx(r,{value:"cannabis",children:"Cannabis"}),e.jsx(r,{value:"hemp",children:"Hemp"}),e.jsx(r,{value:"cbd",children:"CBD Products"}),e.jsx(r,{value:"thc",children:"THC Products"}),e.jsx(r,{value:"equipment",children:"Equipment"}),e.jsx(r,{value:"services",children:"Services"})]})]}),e.jsxs(k,{value:u,onValueChange:w,children:[e.jsx(B,{children:e.jsx(D,{placeholder:"Urgency"})}),e.jsxs(q,{children:[e.jsx(r,{value:"all",children:"All Urgency"}),e.jsx(r,{value:"urgent",children:"Urgent"}),e.jsx(r,{value:"high",children:"High Priority"}),e.jsx(r,{value:"normal",children:"Normal"}),e.jsx(r,{value:"low",children:"Low Priority"})]})]}),e.jsx(n,{variant:"outline",onClick:()=>{v(""),b("all"),w("all")},children:"Clear Filters"})]})})}),e.jsxs(O,{defaultValue:"all",className:"space-y-6",children:[e.jsxs(Z,{className:"grid w-full max-w-md grid-cols-2",children:[e.jsx(U,{value:"all",children:"All Signals"}),t&&e.jsx(U,{value:"mine",children:"My Signals"})]}),e.jsx(P,{value:"all",className:"space-y-6",children:S.length===0?e.jsx(o,{children:e.jsxs(x,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(M,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No signals found"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:l||m!=="all"||u!=="all"?"Try adjusting your filters to find more buy signals.":"Be the first to post a buy signal and let sellers know what you need."}),t&&e.jsx(n,{className:"mt-4",onClick:()=>i("/buy-signals/create"),children:"Create First Signal"})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:S.map(s=>e.jsx(L,{signal:s,showActions:!0},s.id))})}),t&&e.jsx(P,{value:"mine",className:"space-y-6",children:C.length===0?e.jsx(o,{children:e.jsxs(x,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(T,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No signals yet"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:"Create your first buy signal to start receiving offers from sellers."}),e.jsx(n,{className:"mt-4",onClick:()=>i("/buy-signals/create"),children:"Create Buy Signal"})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:C.map(s=>e.jsx(L,{signal:s},s.id))})})]})]})}export{le as default};
