import{i as O,k as T,l as k,r as I,ak as P,n as R,j as e,M as g,o as b,p as y,a1 as q,B as x,a3 as A,a4 as L,at as M,am as V,an as n,ao as r,as as i,aq as l,I as u,ar as o,H as N,J as f,K as C,N as v,O as m,aw as t,al as E,F as _,G as w}from"./index-DE3WvtMD.js";import{T as S}from"./textarea-DxM8kpuO.js";import{A as D}from"./arrow-left-CBn638CS.js";import{B as G}from"./building-2-Di7O9HAg.js";const K=t.object({name:t.string().min(2,"Organization name must be at least 2 characters"),region:t.string().min(1,"Please select a region"),sellerType:t.enum(["direct_seller","broker"]),description:t.string().optional(),website:t.string().url("Please enter a valid website URL").optional().or(t.literal("")),phone:t.string().optional(),address:t.string().optional()}),H=["Eastern Cape","Free State","Gauteng","KwaZulu-Natal","Limpopo","Mpumalanga","Northern Cape","North West","Western Cape"];function J(){const h=O();T();const{toast:j}=k(),[z,F]=I.useState(!1),a=P({resolver:E(K),defaultValues:{name:"",region:"",sellerType:"direct_seller",description:"",website:"",phone:"",address:""}}),d=R({mutationFn:async s=>await(await _("POST","/api/organizations",s)).json(),onSuccess:()=>{F(!0),j({title:"Organization created successfully!",description:"Your business profile has been set up. You can now proceed with uploading documents."}),w.invalidateQueries({queryKey:["/api/organizations"]}),w.invalidateQueries({queryKey:["/api/seller/organization"]}),setTimeout(()=>{h("/onboarding/seller")},2e3)},onError:s=>{j({title:"Failed to create organization",description:s.message,variant:"destructive"})}}),B=s=>{d.mutate(s)},p=()=>{h("/onboarding/seller")};return z?e.jsx(g,{children:e.jsx("div",{className:"container mx-auto py-12",children:e.jsx(b,{className:"max-w-md mx-auto text-center",children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-8 h-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-[#173c1e]",children:"Organization Created!"}),e.jsx("p",{className:"text-sm text-[#173c1e]/70 mt-1",children:"Redirecting you back to complete the onboarding..."})]})]})})})})}):e.jsx(g,{children:e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs(x,{variant:"ghost",onClick:p,className:"mr-4 text-[#173c1e]/70",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Back to Onboarding"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#173c1e]",children:"Create Organization"}),e.jsx("p",{className:"text-[#173c1e]/70",children:"Set up your business profile to start selling on Izenzo"})]})]}),e.jsxs(b,{className:"max-w-2xl mx-auto",children:[e.jsxs(A,{children:[e.jsxs(L,{className:"flex items-center text-[#173c1e]",children:[e.jsx(G,{className:"w-5 h-5 mr-2"}),"Business Information"]}),e.jsx(M,{children:"Provide details about your cannabis business. This information will be displayed to potential buyers."})]}),e.jsx(y,{children:e.jsx(V,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(B),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(n,{control:a.control,name:"name",render:({field:s})=>e.jsxs(r,{children:[e.jsx(i,{children:"Organization Name *"}),e.jsx(l,{children:e.jsx(u,{placeholder:"Your Cannabis Business Name","data-testid":"input-organization-name",...s})}),e.jsx(o,{})]})}),e.jsx(n,{control:a.control,name:"region",render:({field:s})=>e.jsxs(r,{children:[e.jsx(i,{children:"Region *"}),e.jsxs(N,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(l,{children:e.jsx(f,{"data-testid":"select-region",children:e.jsx(C,{placeholder:"Select your region"})})}),e.jsx(v,{children:H.map(c=>e.jsx(m,{value:c.toLowerCase().replace(" ","-"),children:c},c))})]}),e.jsx(o,{})]})}),e.jsx(n,{control:a.control,name:"sellerType",render:({field:s})=>e.jsxs(r,{children:[e.jsx(i,{children:"Business Type *"}),e.jsxs(N,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(l,{children:e.jsx(f,{"data-testid":"select-seller-type",children:e.jsx(C,{placeholder:"Select your business type"})})}),e.jsxs(v,{children:[e.jsx(m,{value:"direct_seller",children:"Direct Seller - I sell my own products"}),e.jsx(m,{value:"broker",children:"Broker - I facilitate trades between buyers and sellers"})]})]}),e.jsx(o,{})]})}),e.jsx(n,{control:a.control,name:"description",render:({field:s})=>e.jsxs(r,{children:[e.jsx(i,{children:"Business Description"}),e.jsx(l,{children:e.jsx(S,{placeholder:"Describe your cannabis business, products, and what makes you unique...",className:"min-h-[120px]","data-testid":"textarea-description",...s})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-[#173c1e]",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:a.control,name:"website",render:({field:s})=>e.jsxs(r,{children:[e.jsx(i,{children:"Website"}),e.jsx(l,{children:e.jsx(u,{placeholder:"https://yourwebsite.com","data-testid":"input-website",...s})}),e.jsx(o,{})]})}),e.jsx(n,{control:a.control,name:"phone",render:({field:s})=>e.jsxs(r,{children:[e.jsx(i,{children:"Phone Number"}),e.jsx(l,{children:e.jsx(u,{placeholder:"+27 123 456 7890","data-testid":"input-phone",...s})}),e.jsx(o,{})]})})]}),e.jsx(n,{control:a.control,name:"address",render:({field:s})=>e.jsxs(r,{children:[e.jsx(i,{children:"Business Address"}),e.jsx(l,{children:e.jsx(S,{placeholder:"Full business address including postal code...","data-testid":"textarea-address",...s})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e.jsx(x,{type:"button",variant:"outline",onClick:p,className:"border-[#173c1e]/20",children:"Cancel"}),e.jsx(x,{type:"submit",disabled:d.isPending,className:"bg-[#173c1e] text-white hover:bg-[#173c1e]/90","data-testid":"button-create-organization",children:d.isPending?"Creating...":"Create Organization"})]})]})})})]})]})})}export{J as default};
