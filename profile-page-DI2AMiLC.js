import{c as K,k as U,l as R,r as V,m as L,ak as Q,al as H,n as Y,j as e,M as k,B as i,o as h,p as u,A as _,z as G,E as W,b as y,S as X,am as J,an as d,ao as o,ap as M,aq as m,I as j,ar as x,w as A,as as Z,aa as ee,L as n,a0 as se,D as ae,q as le,s as te,t as P,v as F,a3 as S,a4 as T,at as I,au as re,ai as ie,av as ne,aw as c,F as ce,G as de}from"./index-DE3WvtMD.js";import{T as oe}from"./textarea-DxM8kpuO.js";import{S as me}from"./square-pen-Bnp_w1Ld.js";import{S as v}from"./shopping-bag-D9-csZ7J.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=K("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=K("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),xe=c.object({fullName:c.string().min(2,"Name must be at least 2 characters"),email:c.string().email("Invalid email address"),bio:c.string().optional(),company:c.string().optional(),location:c.string().min(2,"Location must be at least 2 characters")});function Ne(){const{user:a}=U(),{toast:w}=R(),[O,p]=V.useState(!1),{data:b,isLoading:C}=L({queryKey:[`/api/listings?sellerId=${a==null?void 0:a.id}`],enabled:!!a&&a.role==="seller",staleTime:60*1e3}),{data:t,isLoading:g}=L({queryKey:["/api/orders"],enabled:!!a,staleTime:60*1e3}),r=Q({resolver:H(xe),defaultValues:{fullName:(a==null?void 0:a.fullName)||"",email:(a==null?void 0:a.email)||"",bio:(a==null?void 0:a.bio)||"",company:(a==null?void 0:a.company)||"",location:(a==null?void 0:a.location)||void 0}}),N=Y({mutationFn:async s=>await(await ce("PATCH",`/api/users/${a==null?void 0:a.id}`,s)).json(),onSuccess:()=>{w({title:"Profile updated",description:"Your profile has been successfully updated."}),de.invalidateQueries({queryKey:["/api/user"]}),p(!1)},onError:s=>{w({title:"Update failed",description:s.message,variant:"destructive"})}});function $(s){N.mutate(s)}const f=Array.isArray(b)?b.map(s=>({id:s.id,title:s.title,description:s.description||"",category:s.category,price:`$${s.pricePerUnit}`,priceNumeric:s.pricePerUnit,unit:s.unit,location:s.location,image:s.images&&s.images.length>0?s.images[0]:void 0,status:s.status==="active"?"available":s.status==="pending"?"limited":"sold",minOrder:`${s.minOrderQuantity} ${s.unit}`,isFeatured:s.isFeatured})):[],z=[{accessorKey:"id",header:"Order ID",cell:({row:s})=>e.jsxs("span",{className:"font-medium",children:["#",s.original.id]})},{accessorKey:"listingId",header:"Product",cell:({row:s})=>{var l;return((l=s.original.listing)==null?void 0:l.title)||`Product #${s.original.listingId}`}},{accessorKey:"quantity",header:"Quantity"},{accessorKey:"totalPrice",header:"Total",cell:({row:s})=>e.jsxs("span",{className:"font-medium",children:["$",s.original.totalPrice.toFixed(2)]})},{accessorKey:"status",header:"Status",cell:({row:s})=>{const l=s.original.status,E={pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[l]||"bg-gray-100 text-gray-800";return e.jsx(y,{className:`${E} border-0`,children:l.charAt(0).toUpperCase()+l.slice(1)})}},{accessorKey:"createdAt",header:"Date",cell:({row:s})=>new Date(s.original.createdAt).toLocaleDateString()}];if(!a)return e.jsx(k,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-medium mb-2",children:"Authentication required"}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"Please log in to view your profile"}),e.jsx(i,{onClick:()=>window.location.href="/auth",children:"Log In"})]})})});const D=s=>s.split(" ").map(l=>l[0]).join("").toUpperCase();return e.jsxs(k,{children:[e.jsx("div",{className:"mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-neutral-800",children:"My Profile"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(h,{children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsxs(_,{className:"h-24 w-24 mb-4",children:[e.jsx(G,{src:a.profileImage,alt:a.fullName}),e.jsx(W,{className:"text-lg",children:D(a.fullName)})]}),e.jsx("h2",{className:"text-xl font-bold mb-1",children:a.fullName}),e.jsx("p",{className:"text-neutral-600 mb-2",children:a.role.charAt(0).toUpperCase()+a.role.slice(1)}),a.isVerified&&e.jsx(y,{className:"bg-green-100 text-green-800 mb-2 border-0",children:"Verified User"}),a.verificationLevel&&e.jsxs(y,{variant:"outline",className:"mb-2",children:["Tier ",a.verificationLevel]}),a.rating&&e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[[...Array(Math.floor(a.rating))].map((s,l)=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 text-yellow-400",children:e.jsx("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z",clipRule:"evenodd"})},l)),a.rating%1>=.5&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 text-yellow-400",children:e.jsx("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z",clipRule:"evenodd"})}),[...Array(5-Math.ceil(a.rating))].map((s,l)=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-yellow-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"})},l)),e.jsxs("span",{className:"ml-1 text-sm text-neutral-600",children:["(",a.rating.toFixed(1),")"]})]}),e.jsx(X,{className:"my-4"}),O?e.jsx(J,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit($),className:"space-y-4 w-full",children:[e.jsx(d,{control:r.control,name:"fullName",render:({field:s})=>e.jsxs(o,{className:"flex items-center",children:[e.jsx(M,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx(m,{children:e.jsx(j,{placeholder:"Full Name",...s})}),e.jsx(x,{})]})}),e.jsx(d,{control:r.control,name:"email",render:({field:s})=>e.jsxs(o,{className:"flex items-center",children:[e.jsx(B,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx(m,{children:e.jsx(j,{placeholder:"Email",...s})}),e.jsx(x,{})]})}),e.jsx(d,{control:r.control,name:"company",render:({field:s})=>e.jsxs(o,{className:"flex items-center",children:[e.jsx(q,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx(m,{children:e.jsx(j,{placeholder:"Company (Optional)",...s})}),e.jsx(x,{})]})}),e.jsx(d,{control:r.control,name:"location",render:({field:s})=>e.jsxs(o,{className:"flex items-center",children:[e.jsx(A,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx(m,{children:e.jsx(j,{placeholder:"Location",...s})}),e.jsx(x,{})]})}),e.jsx(d,{control:r.control,name:"bio",render:({field:s})=>e.jsxs(o,{children:[e.jsx(Z,{children:"Bio"}),e.jsx(m,{children:e.jsx(oe,{placeholder:"Tell us about yourself",className:"resize-none",...s})}),e.jsx(x,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(i,{type:"button",variant:"outline",onClick:()=>p(!1),children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Cancel"]}),e.jsxs(i,{type:"submit",disabled:N.isPending,children:[N.isPending?e.jsx(n,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(se,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx("span",{children:a.fullName})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx("span",{children:a.email})]}),a.company&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx("span",{children:a.company})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-5 w-5 text-neutral-400 mr-2"}),e.jsx("span",{children:a.location})]})]}),a.bio&&e.jsx("div",{className:"mt-4 p-4 bg-neutral-50 rounded-lg",children:e.jsx("p",{className:"text-neutral-600 text-sm",children:a.bio})}),e.jsxs(i,{variant:"outline",className:"mt-4",onClick:()=>p(!0),children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Edit Profile"]})]})]})})}),e.jsx(h,{children:e.jsxs(u,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Account Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-neutral-50 p-4 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(v,{className:"h-5 w-5 text-primary"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-sm text-neutral-600",children:"Completed Trades"}),e.jsx("p",{className:"text-2xl font-bold",children:g?e.jsx(n,{className:"h-5 w-5 animate-spin mx-auto"}):Array.isArray(t)?t.filter(s=>s.status==="completed").length:0})]})]}),e.jsxs("div",{className:"bg-neutral-50 p-4 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(ae,{className:"h-5 w-5 text-primary"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-sm text-neutral-600",children:a.role==="seller"?"Active Listings":"Pending Orders"}),e.jsx("p",{className:"text-2xl font-bold",children:a.role==="seller"?C?e.jsx(n,{className:"h-5 w-5 animate-spin mx-auto"}):f.filter(s=>s.status==="available").length:g?e.jsx(n,{className:"h-5 w-5 animate-spin mx-auto"}):Array.isArray(t)?t.filter(s=>s.status==="pending").length:0})]})]})]})]})})]}),e.jsx("div",{className:"md:col-span-2 space-y-6",children:e.jsxs(le,{defaultValue:"orders",children:[e.jsxs(te,{className:"mb-4",children:[e.jsx(P,{value:"orders",children:"My Orders"}),a.role==="seller"&&e.jsx(P,{value:"listings",children:"My Listings"})]}),e.jsx(F,{value:"orders",children:e.jsxs(h,{children:[e.jsxs(S,{children:[e.jsx(T,{children:"Order History"}),e.jsx(I,{children:"View and manage your orders"})]}),e.jsx(u,{children:g?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx(n,{className:"h-8 w-8 animate-spin text-primary"})}):Array.isArray(t)&&t.length>0?e.jsx(re,{columns:z,data:t,searchKey:"id",searchPlaceholder:"Search orders..."}):e.jsxs("div",{className:"text-center p-8",children:[e.jsx(v,{className:"h-12 w-12 text-neutral-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No orders yet"}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"You haven't placed any orders."}),e.jsx(i,{onClick:()=>window.location.href="/listings",children:"Browse Listings"})]})})]})}),a.role==="seller"&&e.jsx(F,{value:"listings",children:e.jsxs(h,{children:[e.jsxs(S,{children:[e.jsx(T,{children:"My Listings"}),e.jsx(I,{children:"Manage your product listings"})]}),e.jsx(u,{children:C?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx(n,{className:"h-8 w-8 animate-spin text-primary"})}):f.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.map(s=>e.jsx(ie,{...s},s.id))}):e.jsxs("div",{className:"text-center p-8",children:[e.jsx(v,{className:"h-12 w-12 text-neutral-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No listings yet"}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"You haven't created any listings."}),e.jsx(i,{onClick:()=>window.location.href="/listings/new",children:"Create New Listing"})]})}),e.jsx(ne,{children:e.jsx(i,{variant:"outline",className:"w-full",onClick:()=>window.location.href="/listings/new",children:"Create New Listing"})})]})})]})})]})]})}export{Ne as default};
