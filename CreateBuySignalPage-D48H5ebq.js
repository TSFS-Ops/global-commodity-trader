import{k,i as q,l as F,a6 as M,r as U,ak as E,n as I,j as e,o as C,p as S,aT as L,B as m,a3 as R,a4 as V,ad as O,at as Q,am as H,an as l,ao as t,as as i,aq as c,I as d,aD as h,ar as o,H as j,J as p,K as b,N as y,O as u,b as K,D as w,w as W,aw as r,al as Z,F as z}from"./index-DE3WvtMD.js";import{T as J}from"./textarea-DxM8kpuO.js";import{A as Y}from"./arrow-left-CBn638CS.js";import{C as $}from"./calendar-DiUGKtnE.js";const G=r.object({title:r.string().min(5,"Title must be at least 5 characters"),description:r.string().min(20,"Description must be at least 20 characters"),category:r.enum(["cannabis","hemp","cbd","thc","equipment","services"]),targetQuantity:r.number().positive("Quantity must be positive").optional(),unit:r.string().optional(),budgetMin:r.number().positive("Budget must be positive").optional(),budgetMax:r.number().positive("Budget must be positive").optional(),currency:r.string().default("USD"),preferredLocation:r.string().optional(),urgency:r.enum(["low","normal","high","urgent"]).default("normal"),expiresAt:r.string().optional(),specifications:r.record(r.string()).optional()});function ae(){const{user:D}=k(),x=q(),{toast:v}=F(),f=M(),[g,N]=U.useState(!1),n=E({resolver:Z(G),defaultValues:{title:"",description:"",category:"cannabis",currency:"USD",urgency:"normal",specifications:{}}}),A=I({mutationFn:async s=>await z("/api/buy-signals","POST",s),onSuccess:()=>{v({title:"Buy Signal Created",description:"Your buy signal is now live and visible to sellers."}),f.invalidateQueries({queryKey:["/api/my-buy-signals"]}),f.invalidateQueries({queryKey:["/api/buy-signals"]}),x("/buy-signals")},onError:s=>{v({title:"Error Creating Signal",description:s.message||"Failed to create buy signal. Please try again.",variant:"destructive"})}}),B=async s=>{N(!0);try{let a={...s};s.expiresAt&&(a.expiresAt=new Date(s.expiresAt).toISOString()),await A.mutateAsync(a)}finally{N(!1)}},T=[{value:"cannabis",label:"Cannabis"},{value:"hemp",label:"Hemp"},{value:"cbd",label:"CBD Products"},{value:"thc",label:"THC Products"},{value:"equipment",label:"Equipment"},{value:"services",label:"Services"}],P=[{value:"low",label:"Low Priority",color:"bg-gray-100 text-gray-800"},{value:"normal",label:"Normal",color:"bg-blue-100 text-blue-800"},{value:"high",label:"High Priority",color:"bg-orange-100 text-orange-800"},{value:"urgent",label:"Urgent",color:"bg-red-100 text-red-800"}];return D?e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(m,{variant:"ghost",onClick:()=>x(-1),className:"mb-4",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Create Buy Signal"}),e.jsx("p",{className:"text-muted-foreground",children:`Post a "want ad" to let sellers know what you're looking for`})]})]}),e.jsxs(C,{children:[e.jsxs(R,{children:[e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"New Buy Signal"]}),e.jsx(Q,{children:"Tell sellers exactly what you need. Be specific to get better responses."})]}),e.jsx(S,{children:e.jsx(H,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(B),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(l,{control:n.control,name:"title",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Title *"}),e.jsx(c,{children:e.jsx(d,{placeholder:"e.g., Looking for high-quality hemp flower...",...s})}),e.jsx(h,{children:"A clear, descriptive title for what you're seeking"}),e.jsx(o,{})]})})}),e.jsx(l,{control:n.control,name:"category",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Category *"}),e.jsxs(j,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(c,{children:e.jsx(p,{children:e.jsx(b,{placeholder:"Select category"})})}),e.jsx(y,{children:T.map(a=>e.jsx(u,{value:a.value,children:a.label},a.value))})]}),e.jsx(o,{})]})}),e.jsx(l,{control:n.control,name:"urgency",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Urgency"}),e.jsxs(j,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(c,{children:e.jsx(p,{children:e.jsx(b,{placeholder:"Select urgency"})})}),e.jsx(y,{children:P.map(a=>e.jsx(u,{value:a.value,children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(K,{className:a.color,children:a.label})})},a.value))})]}),e.jsx(o,{})]})})]}),e.jsx(l,{control:n.control,name:"description",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Description *"}),e.jsx(c,{children:e.jsx(J,{placeholder:"Describe exactly what you're looking for, including quality requirements, intended use, certifications needed, etc.",className:"min-h-[120px]",...s})}),e.jsx(h,{children:"Provide detailed specifications to help sellers understand your needs"}),e.jsx(o,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(l,{control:n.control,name:"targetQuantity",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Target Quantity"}),e.jsx(c,{children:e.jsx(d,{type:"number",step:"0.01",placeholder:"100",...s,onChange:a=>s.onChange(a.target.value?Number(a.target.value):void 0)})}),e.jsx(o,{})]})}),e.jsx(l,{control:n.control,name:"unit",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Unit"}),e.jsx(c,{children:e.jsx(d,{placeholder:"kg, grams, liters",...s})}),e.jsx(o,{})]})}),e.jsx(l,{control:n.control,name:"currency",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Currency"}),e.jsxs(j,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(c,{children:e.jsx(p,{children:e.jsx(b,{})})}),e.jsxs(y,{children:[e.jsx(u,{value:"USD",children:"USD ($)"}),e.jsx(u,{value:"ZAR",children:"ZAR (R)"}),e.jsx(u,{value:"EUR",children:"EUR (â‚¬)"})]})]}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{control:n.control,name:"budgetMin",render:({field:s})=>e.jsxs(t,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Minimum Budget"]}),e.jsx(c,{children:e.jsx(d,{type:"number",step:"0.01",placeholder:"1000",...s,onChange:a=>s.onChange(a.target.value?Number(a.target.value):void 0)})}),e.jsx(o,{})]})}),e.jsx(l,{control:n.control,name:"budgetMax",render:({field:s})=>e.jsxs(t,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Maximum Budget"]}),e.jsx(c,{children:e.jsx(d,{type:"number",step:"0.01",placeholder:"5000",...s,onChange:a=>s.onChange(a.target.value?Number(a.target.value):void 0)})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(l,{control:n.control,name:"preferredLocation",render:({field:s})=>e.jsxs(t,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Preferred Location"]}),e.jsx(c,{children:e.jsx(d,{placeholder:"Cape Town, South Africa",...s})}),e.jsx(h,{children:"Where you'd prefer to source from or receive delivery"}),e.jsx(o,{})]})}),e.jsx(l,{control:n.control,name:"expiresAt",render:({field:s})=>e.jsxs(t,{children:[e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Expires On"]}),e.jsx(c,{children:e.jsx(d,{type:"date",min:new Date().toISOString().split("T")[0],...s})}),e.jsx(h,{children:"When this signal should expire (optional)"}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>x(-1),disabled:g,children:"Cancel"}),e.jsx(m,{type:"submit",disabled:g,className:"min-w-[120px]",children:g?"Creating...":"Create Signal"})]})]})})})]})]}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(C,{className:"max-w-md mx-auto",children:e.jsxs(S,{className:"flex flex-col items-center space-y-4 pt-6",children:[e.jsx(L,{className:"h-12 w-12 text-amber-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-semibold",children:"Authentication Required"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Please log in to create a buy signal."})]}),e.jsx(m,{onClick:()=>x("/login"),children:"Log In"})]})})})}export{ae as default};
